(()=>{"use strict";var e={20:(e,t,r)=>{var n=r(609),a=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,r){var n,o={},i=null,l=null;for(n in void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,n)&&!u.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:a,type:e,key:i,ref:l,props:o,_owner:c.current}}t.Fragment=o,t.jsx=i,t.jsxs=i},848:(e,t,r)=>{e.exports=r(20)},609:e=>{e.exports=window.React}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}(()=>{const e=window.wc.blocksCheckout,t=window.wc.wcSettings,n=window.wp.i18n,a=window.wp.data,o=e=>(0,t.getSetting)(`${e}_data`),s=e=>(0,n.__)(e,"revolut-gateway-for-woocommerce"),c=(e,t="revolut_payment_request_")=>wc_revolut_payment_request_params.ajax_url.toString().replace("%%wc_revolut_gateway_ajax_endpoint%%",`${t}${e}`);function u(e,t,r){const n=e;if(t&&"object"==typeof t)Object.keys(t).forEach((e=>{u(n,t[e],r?`${r}[${e}]`:e)}));else{const e=null==t?"":t;n.append(r,e)}return n}const i=async({data:e,endpoint:t})=>{const r=u(new FormData,e),n=await fetch(t,{method:"POST",body:r});if(!n.ok)throw new Error("Failed to process your request due to network issue");return await n.json()},l=e=>({countryCode:e.country,region:e.state,city:e.city,streetLine1:e.address_1,streetLine2:e.address_2,postcode:e.postcode}),d=async()=>{if("undefined"==typeof wc_revolut_payment_request_params)return Promise.reject(new Error("Unexpected error occurred"));const e=await i({endpoint:c("get_express_checkout_params"),data:{security:wc_revolut_payment_request_params.nonce.get_express_checkout_params}});return e?.success?(wc_revolut_payment_request_params.revolut_public_id=e.revolut_public_id,e.revolut_public_id):Promise.reject(new Error("Something went wrong while creating the payment."))},p=async e=>{const t=await i({endpoint:e.create_revolut_order_endpoint,data:{security:e.create_revolut_order_nonce}});if(t?.success)return t;throw new Error("An unexpected error occurred")},m=async()=>(await i({data:{revolut_public_id:wc_revolut_payment_request_params.revolut_public_id,security:wc_revolut_payment_request_params.nonce.cancel_order},endpoint:c("cancel_order")})).success,_=async()=>{try{if(await m())return{type:"error",message:s("Something went wrong, your order has been cancelled.")};throw new Error("Couldn`t cancel the order")}catch(e){return{type:"failure",message:s("Your order has been completed, but we couldn't redirect you to the confirmation page. Please contact us for assistance.")}}},y=async({response:e,paymentMethod:t,shouldSavePayment:r})=>{try{const{processingResponse:n}=e,{wc_order_id:a,revolut_public_id:s,process_payment_result:c}=n.paymentDetails,u=await(async({process_payment_result:e,revolut_public_id:t,shouldSavePayment:r,wc_order_id:n,paymentMethod:a})=>{try{const s=o(a),c={revolut_gateway:a,security:e,revolut_public_id:t,revolut_payment_error:"",wc_order_id:n,reload_checkout:0,revolut_save_payment_method:Number(r)||Number(s.is_save_payment_method_mandatory)},u=await i({data:c,endpoint:s.process_order_endpoint});if("fail"===u?.result)throw new Error(u?.messages||"Something went wrong while trying to charge your card, please try again");if("success"===u?.result)return u;throw new Error("Failed to process your order due to server issue")}catch(e){throw new Error(e.message||"An unexpected error occurred")}})({wc_order_id:a,revolut_public_id:s,process_payment_result:c,shouldSavePayment:r,paymentMethod:t});if(u.redirect)return window.location.href=decodeURI(u.redirect),{type:"success"};throw new Error("Could not redirect you to the confirmation page due to an unexpected error. Please contact the merchant")}catch(e){return{type:"error",message:s(e?.message),retry:!0,messageContext:"wc/checkout/payments"}}},h=async({onSubmit:e})=>new Promise(((t,r)=>(async()=>{try{const e=await i({data:{security:wc_revolut_payment_request_params.nonce.load_order_data,revolut_public_id:wc_revolut_payment_request_params.revolut_public_id},endpoint:c("load_order_data")});if(e)return e;throw new Error("Something went wrong while retrieving the billing address. your payment will be cancelled")}catch(e){throw new Error(e.message||"An unexpected error occurred.")}})().then((r=>{const{billingAddress:n,shippingAddress:o}=r.address_info;let s=n.recipient.indexOf(" "),c=n.recipient.substring(0,s),u=n.recipient.substring(s+1);(0,a.dispatch)(C).setBillingAddress({first_name:c,last_name:u,address_1:n.address,address_2:n.address_2,city:n.city,state:n.state,postcode:n.postcode,country:n.country,email:r.address_info.email,phone:n.phone}),(0,a.dispatch)(C).setShippingAddress({first_name:c,last_name:u,address_1:o.address,address_2:o.address_2,city:o.city,state:o.state,postcode:o.postcode,country:o.country,phone:o.phone}),e(),t(!0)})).catch((e=>r(e))))),{revPointsBannerEnabled:v,gatewayUpsellBannerEnabled:w,revolutPayIconVariant:f,amount:g,locale:b,publicToken:E,currency:S}=wc_revolut.informational_banner_data,k="undefined"!=typeof RevolutUpsell?RevolutUpsell({locale:b,publicToken:E}):null,R={channel:"woocommerce-blocks"},P=()=>{const e=document.getElementById(L);k&&e&&v&&k.promotionalBanner.mount(e,{amount:g,variant:"banner",currency:S,__metadata:R})},{CART_STORE_KEY:C,PAYMENT_STORE_KEY:x}=window.wc.wcBlocksData,T="revolut_cc",q="revolut_pay",A="revolut_payment_request",O="undefined"!=typeof wc_revolut_payment_request_params&&wc_revolut_payment_request_params.is_cart_page,L="revolut-pay-informational-banner";var M=r(609);const j=window.wp.element,I=["error.3ds-failed","error.email-is-not-specified","error.invalid-postcode","error.invalid-email","error.incorrect-cvv-code","error.expired-card","error.do-not-honour","error.insufficient-funds"],N=({paymentOptions:e,onSuccess:t,onError:r},n)=>{const a=(0,j.useRef)(null),s=(0,j.useRef)(),c=o(A);return(0,j.useEffect)((()=>((async()=>{const{paymentRequest:n,destroy:o}=await RevolutCheckout.payments({publicToken:c.merchant_public_key,locale:c.locale});if(s.current=o,a.current){const o=n.mount(a.current,{...e,onSuccess(){t()},onError(e){r(e.message)},onCancel(){r("Payment cancelled!")}});o.canMakePayment().then((e=>{e?o.render():o.destroy()}))}})(),()=>s.current())),n),{revolutPrbRef:a,destroyRef:s}},D=()=>{(0,j.useEffect)((()=>{const e=document.querySelector(".wp-element-button.wc-block-components-checkout-place-order-button");return e&&(e.disabled=!0,e.style.display="none"),()=>{e&&(e.disabled=!1,e.style.display="block")}}),[])},B=({paymentOptions:e,onSuccess:t,onError:r,onCancel:n},a)=>{const s=(0,j.useRef)(null),c=(0,j.useRef)(),u=o(q);return(0,j.useEffect)((()=>((async()=>{const{revolutPay:a,destroy:o}=await RevolutCheckout.payments({publicToken:u.merchant_public_key,locale:u.locale});c.current=o,s.current&&a.mount(s.current,e),a.on("payment",(e=>{switch(e.type){case"cancel":n();break;case"success":t();break;case"error":r(e.error.message)}}))})(),()=>{c.current()})),a),{revolutPayRef:s,destroyRef:c}},F=({settings:e})=>{const{available_card_brands:t,wc_revolut_plugin_url:r,title:n}=e;return(0,j.useEffect)((()=>{e.payment_method_name===q&&(()=>{const e=document.getElementById("revolut-pay-label-informational-icon");k&&e&&f&&k.promotionalBanner.mount(e,{amount:g,variant:"cashback"===f?"link":f,currency:S,style:{text:"cashback"===f?"cashback":null,color:"blue"},__metadata:R})})()}),[]),(0,M.createElement)("div",{className:"revolut-payment-method-label-container"},(0,M.createElement)("strong",{dangerouslySetInnerHTML:{__html:n}}),(0,M.createElement)("div",{className:"revolut-payment-method-label-scheme-icons"},t&&t.filter((e=>"maestro"!==e)).map((e=>(0,M.createElement)("img",{key:e,src:`${r}/assets/images/${e}.svg`,style:{marginLeft:2},alt:e})))))},U=({inputRef:e})=>{const[t,r]=(0,j.useState)([]),n=(0,j.useRef)(!1),a=()=>{const t=2===e.current.value.trim().split(/\s+/).length;return!t&&n.current?(e.current.classList.add("wc-revolut-cardholder-name-error"),r([{message:"Please provide your full name"}])):(e.current.classList.remove("wc-revolut-cardholder-name-error"),r([])),t};return e.current&&(e.current.isComplete=()=>(n.current=!0,a())),(0,M.createElement)("div",{className:"form-row form-row-first validate-required",id:"cardholder-name","data-priority":"10",style:{display:"block",width:"100%",marginBottom:15}},(0,M.createElement)("input",{ref:e,type:"text",onChange:a,className:"input-text",name:"wc-revolut-cardholder-name",id:"wc-revolut-cardholder-name",placeholder:"Cardholder name",autoComplete:"cardholder",required:!0}),(0,M.createElement)("div",{style:{marginBottom:10,marginTop:10}},(0,M.createElement)(Y,{errorList:t})))},Y=({errorList:e})=>(0,M.createElement)("div",null,e.map(((e,t)=>(0,M.createElement)("li",{className:"card-field-error",key:t},e.message)))),$=({orderToken:e})=>((0,j.useEffect)((()=>{(e=>{const t=document.getElementById("revolut-upsell-banner");k&&t&&w&&k.cardGatewayBanner.mount(t,{orderToken:e})})(e)}),[e]),(0,M.createElement)("div",{id:"revolut-upsell-banner"}));var V=r(848);const G=o(T),K={name:T,label:(0,M.createElement)(F,{settings:G}),content:(0,M.createElement)((({eventRegistration:e,billing:t,shippingData:r,shouldSavePayment:n,emitResponse:c,components:u,checkoutStatus:i})=>{const d=T,{onPaymentSetup:m,onCheckoutSuccess:_}=e,h=o(d),v=(0,j.useRef)(),w=(0,j.useRef)(),[f,g]=(0,j.useState)(!1),[b,E]=(0,j.useState)([]),[S,k]=(0,j.useState)(!1),[R,P]=(0,j.useState)(""),[C,x]=(0,j.useState)(0),{createErrorNotice:q,removeAllNotices:A}=(0,a.dispatch)("core/notices");(0,j.useEffect)((()=>{const e=m(L),t=_(M);return()=>{e(),t()}}),[_,m,b,f,n,t.billingAddress,r.shippingAddress]),(0,j.useEffect)((()=>{(async()=>{t?.cartTotal?.value&&(k(!0),p(h).then((e=>{P(e.revolut_order_public_id),x(e.revolut_order_amount),k(!1)})).catch((e=>q(s(e.message||"An unexpected error occurred"),{id:"create_order_failed",context:c.noticeContexts.PAYMENTS}))))})()}),[t.cartTotal.value]);const O=(({onMsg:e,publicId:t,locale:r},n)=>{const a=(0,j.useRef)(e),o=(0,j.useRef)(null),s=(0,j.useRef)(null);return(0,j.useEffect)((()=>{let e=!1;return s.current&&(s.current.destroy(),a.current({type:"instance_destroyed"})),RevolutCheckout(t).then((t=>{!e&&o.current&&(s.current=t.createCardField({locale:r,target:o.current,onSuccess(){a.current({type:"payment_successful"})},onError(e){I.includes(e.type)?a.current({type:"fields_errors_changed",errors:[e]}):a.current({type:"payment_failed",error:e})},onValidation:e=>a.current({type:"fields_errors_changed",errors:e}),onStatusChange:e=>{a.current({type:"fields_status_changed",status:e})},onCancel(){a.current({type:"payment_cancelled"})}}),a.current({type:"instance_mounted",instance:s.current}))})),()=>{e=!0,s.current&&(s.current.destroy(),s.current=null,a.current({type:"instance_destroyed"}))}}),[t,a,r,...n]),o})({publicId:R,locale:h.locale,onMsg:e=>{switch(e.type){case"payment_successful":document.dispatchEvent(new Event("payment_successful"));break;case"payment_failed":document.dispatchEvent(new CustomEvent("payment_failed",{detail:e.error.toString()}));break;case"instance_destroyed":v.current=null;break;case"instance_mounted":v.current=e.instance;break;case"fields_errors_changed":E(e.errors);break;case"fields_status_changed":g(e.status)}}},[C]),L=async()=>{A();let e=null;return t?.billingAddress||(e="Please check your billing address, and retry again."),(!f.completed||b.length>0)&&(e="The payment form is not ready for submission.",v.current&&(v.current.validate(),e="The payment form is not ready for submission. please fix the errors below and retry again.")),h.card_holder_name_field_enabled&&(w.current.isComplete()||(e="The payment form is not ready for submission. please fix the errors below and retry again.")),e?{type:c.responseTypes.ERROR,message:s(e),retry:!0,messageContext:c.noticeContexts.PAYMENTS}:{type:c.responseTypes.SUCCESS}},M=async e=>{k(!0);const{billingAddress:a}=t,{shippingAddress:o}=r,u={name:h.card_holder_name_field_enabled&&w.current.value.length>0?w.current.value:`${a.first_name} ${a.last_name}`,email:a.email,phone:a.phone,savePaymentMethodFor:n||h.is_save_payment_method_mandatory?"merchant":""};void 0!==a.country&&void 0!==a.postcode&&(u.billingAddress=l(a),u.shippingAddress=l(a)),o&&void 0!==o.country&&void 0!==o.postcode&&(u.shippingAddress=l(o));const i=await N({paymentData:u});if(!i.success)return i.error?(k(!1),{type:c.responseTypes.ERROR,message:s(i.error||"Unexpected error occurred, please try again later"),retry:!0,messageContext:c.noticeContexts.PAYMENTS}):void k(!1);y({response:e,paymentMethod:T,shouldSavePayment:n})},N=async({paymentData:e})=>(v.current.submit(e),new Promise(((e,t)=>{document.addEventListener("payment_successful",(()=>{e({success:!0})})),document.addEventListener("payment_failed",(t=>{e({success:!1,error:t.detail})}))})));return(0,j.useEffect)((()=>{O.current&&(b.length>0?O.current.classList.add("woocommerce-revolut-card-element-error"):O.current.classList.remove("woocommerce-revolut-card-element-error"))}),[b]),(0,V.jsx)(V.Fragment,{children:(0,V.jsx)(u.LoadingMask,{showSpinner:!0,isLoading:i.isProcessing||i.isComplete||S,children:R&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{id:"woocommerce-revolut-card-element",ref:O}),b.length>0&&(0,V.jsx)(Y,{errorList:b})]}),h.card_holder_name_field_enabled&&(0,V.jsx)("div",{style:{marginTop:10},children:(0,V.jsx)(U,{inputRef:w})}),h.promotional_banner_enabled&&(0,V.jsx)("div",{children:(0,V.jsx)($,{orderToken:R})})]})})})}),null),edit:(0,M.createElement)("p",null,s("Revolut Gateway is not available in editor mode")),ariaLabel:s("Revolut Card`s Gateway"),canMakePayment:()=>G.can_make_payment,supports:{features:["products"],showSavedCards:!0,showSaveOption:!G.is_save_payment_method_mandatory}},z=()=>((0,j.useEffect)((()=>{P()}),[]),(0,V.jsx)("div",{id:L})),H={metadata:{name:"revolut-gateway-for-woocommerce/revolut-banner",category:"woocommerce",parent:[e.innerBlockAreas.CHECKOUT_ORDER_SUMMARY],attributes:{lock:{type:"object",default:{remove:!0,move:!0}}}},force:!0,component:()=>(0,V.jsx)(z,{})},W=o(A),J={name:"revolut_payment_request",label:(0,M.createElement)(F,{settings:W}),content:O?(0,M.createElement)((({billing:e,setExpressPaymentError:t,eventRegistration:r,onSubmit:n,onClick:a,onClose:s,emitResponse:u})=>{const{onPaymentSetup:l,onCheckoutFail:p}=r,y=o(A),{revolutPrbRef:v,destroyRef:w}=N({paymentOptions:{currency:y.order_currency,amount:0,requestShipping:!0,shippingOptions:wc_revolut_payment_request_params.free_shipping_option,validate:()=>(a(),!0),onShippingOptionChange:e=>function(e){let t={security:wc_revolut_payment_request_params.nonce.update_shipping,shipping_method:[e.id],is_product_page:wc_revolut_payment_request_params.is_product_page};return new Promise(((e,r)=>{i({data:t,endpoint:c("update_shipping_method")}).then((t=>{e(t)})).catch((e=>{r(e)}))}))}(e),onShippingAddressChange:e=>function(e){let t={security:wc_revolut_payment_request_params.nonce.shipping,country:e.country,state:e.region,postcode:e.postalCode,city:e.city,address:"",address_2:"",is_product_page:wc_revolut_payment_request_params.is_product_page,require_shipping:wc_revolut_payment_request_params.shipping_required};return new Promise(((e,r)=>{i({data:t,endpoint:c("get_shipping_options")}).then((t=>{e(t)})).catch((e=>{r(e)}))}))}(e),createOrder:()=>new Promise(((e,t)=>{d().then((t=>{e({publicId:t})})).catch((e=>{t(e)}))})),buttonStyle:{action:wc_revolut_payment_request_params.payment_request_button_type,size:wc_revolut_payment_request_params.payment_request_button_size,variant:wc_revolut_payment_request_params.payment_request_button_theme,radius:wc_revolut_payment_request_params.payment_request_button_radius}},onSuccess:()=>h({onSubmit:n}).catch((e=>{w.current(),m(),t(e)})),onError:e=>{t(e||"Something went wrong while completing your payment"),s()},onCancel:e=>{t(e),s()}},[e.cartTotal.value]);return(0,j.useEffect)((()=>{const e=l((()=>({type:u.responseTypes.SUCCESS,meta:{paymentMethodData:{is_express_checkout:1}}}))),r=p((()=>{_().then((e=>{t(e.message),"failure"===e.type&&w.current()}))}));return()=>{e(),r()}}),[l,p]),(0,M.createElement)(M.Fragment,null," ",(0,M.createElement)("div",{ref:v}))}),null):(0,M.createElement)((({billing:e,components:t,checkoutStatus:r,eventRegistration:n,emitResponse:s,onSubmit:c})=>{const{onCheckoutSuccess:u,onCheckoutFail:i}=n,{VALIDATION_STORE_KEY:l}=window.wc.wcBlocksData,[d,m]=(0,j.useState)(!1),_=o(A),h=(0,j.useRef)(null),v=(0,j.useRef)(null),w=(0,j.useRef)(null),{revolutPrbRef:f}=N({paymentOptions:{currency:_.order_currency,amount:e.cartTotal.value,validate:()=>new Promise(((e,t)=>{m(!0),(0,a.select)(l).hasValidationErrors()&&(m(!1),t("Checkout form is incomplete")),p(_).then((r=>{h.current=r.revolut_order_public_id,c(),document.addEventListener("checkout_success",(()=>{e(!0)})),document.addEventListener("checkout_fail",(()=>{m(!1),t("Something went wrong")}))}))})),createOrder:()=>({publicId:h.current})},onSuccess:()=>{m(!0),y({response:v.current,paymentMethod:A,shouldSavePayment:0})},onError:e=>{m(!1),w.current&&w.current.resolve((e=>({type:s.responseTypes.ERROR,message:e,retry:!0,messageContext:s.noticeContexts.PAYMENTS}))(e))}},[e.cartTotal.value]);return(0,j.useEffect)((()=>{const e=u((async e=>new Promise((t=>{m(!1),v.current=e,document.dispatchEvent(new CustomEvent("checkout_success")),w.current={resolve:t}})))),t=i((e=>{e&&e.paymentDetails&&e.paymentDetails.wc_order_id||document.dispatchEvent(new CustomEvent("checkout_fail"))}));return()=>{e(),t()}}),[u,i]),D(),(0,M.createElement)(M.Fragment,null," ",(0,M.createElement)(t.LoadingMask,{showSpinner:!0,isLoading:d||r.isProcessing||r.isComplete},(0,M.createElement)("div",{ref:f})))}),null),edit:(0,M.createElement)("p",null,s("Google/Apple Pay block is not available in editor mode")),ariaLabel:"Google Pay/Apple Pay",canMakePayment:()=>W.can_make_payment,paymentMethodId:"revolut_payment_request",supports:{features:["products"]}},Q=o(q),X=new URLSearchParams(window.location.search),Z=X.get("_rp_fr"),ee=X.get("_rp_oid"),te=X.get("_rp_s");(Z||!te&&ee)&&((0,a.dispatch)("core/notices").createErrorNotice(s(Z||"Payment Rejected"),{id:"rp-fr",context:"wc/checkout/payments"}),O||(0,a.dispatch)(x).__internalSetActivePaymentMethod(q));const re={name:"revolut_pay",label:(0,M.createElement)(F,{settings:Q}),content:O?(0,M.createElement)((({billing:e,setExpressPaymentError:t,eventRegistration:r,onSubmit:n,onClick:a,onClose:s,emitResponse:c})=>{const{onPaymentSetup:u,onCheckoutFail:i}=r,l=o(q),p={currency:l.order_currency,totalAmount:0,mobileRedirectUrls:{success:l.mobile_redirect_url,failure:l.mobile_redirect_url,cancel:l.mobile_redirect_url},buttonStyle:{cashbackCurrency:wc_revolut_payment_request_params.currency,variant:wc_revolut_payment_request_params.revolut_pay_button_theme,size:wc_revolut_payment_request_params.revolut_pay_button_size,radius:wc_revolut_payment_request_params.revolut_pay_button_radius},requestShipping:!0,validate:()=>(a(),!0),createOrder:()=>new Promise(((e,t)=>{d().then((t=>{e({publicId:t})})).catch((e=>{t(e)}))}))},{revolutPayRef:y,destroyRef:v}=B({paymentOptions:p,onSuccess:()=>h({onSubmit:n}).catch((e=>{v.current(),m(),t(e)})),onError:e=>{t(e||"Something went wrong while completing your payment"),s()},onCancel:e=>{t(e||"Payment cancelled!"),s()}},[e.cartTotal.value]);return(0,j.useEffect)((()=>{const e=u((()=>({type:c.responseTypes.SUCCESS,meta:{paymentMethodData:{is_express_checkout:1}}}))),r=i((()=>{_().then((e=>{t(e.message),"failure"===e.type&&v.current()}))}));return()=>{e(),r()}}),[u,i]),(0,j.useEffect)((()=>{P()}),[]),(0,V.jsxs)(V.Fragment,{children:[" ",(0,V.jsx)("div",{id:L}),(0,V.jsx)("div",{ref:y})]})}),null):(0,M.createElement)((({billing:e,components:t,eventRegistration:r,onSubmit:n,emitResponse:s})=>{const{onCheckoutSuccess:c,onCheckoutFail:u}=r,{VALIDATION_STORE_KEY:i}=window.wc.wcBlocksData,l=o(q),[d,m]=(0,j.useState)(!1),[_,h]=(0,j.useState)(!1),v=(0,j.useRef)(null),w=(0,j.useRef)(null),f=(0,j.useRef)(null),g=e=>({type:s.responseTypes.ERROR,message:e,retry:!0,messageContext:s.noticeContexts.PAYMENTS}),b={currency:l.order_currency,totalAmount:e.cartTotal.value,mobileRedirectUrls:{success:l.mobile_redirect_url,failure:l.mobile_redirect_url,cancel:l.mobile_redirect_url},validate:()=>(h(!1),new Promise((e=>{m(!0),(0,a.select)(i).hasValidationErrors()&&(m(!1),e(!1)),p(l).then((t=>{v.current=t.revolut_order_public_id,n(),document.addEventListener("checkout_success",(()=>{e(!0)})),document.addEventListener("checkout_fail",(()=>{m(!1),e(!1)}))}))}))),createOrder:()=>({publicId:v.current})},{revolutPayRef:E}=B({paymentOptions:b,onSuccess:()=>{m(!0),y({response:w.current,paymentMethod:q,shouldSavePayment:0})},onError:e=>{m(!1),f.current&&f.current.resolve(g(e))},onCancel:()=>{h(!0),f.current&&f.current.resolve(g("Payment cancelled!"))}},[e.cartTotal.value]);return(0,j.useEffect)((()=>{const e=c((async e=>new Promise((t=>{if(_)return m(!1),t(g("Payment cancelled!"));m(!1),w.current=e,document.dispatchEvent(new CustomEvent("checkout_success")),f.current={resolve:t}})))),t=u((e=>{e&&e.paymentDetails&&e.paymentDetails.wc_order_id||document.dispatchEvent(new CustomEvent("checkout_fail"))}));return()=>{e(),t()}}),[c,u,_]),D(),(0,M.createElement)(M.Fragment,null," ",(0,M.createElement)(t.LoadingMask,{showSpinner:!0,isLoading:d},(0,M.createElement)("div",{ref:E})))}),null),edit:(0,M.createElement)("p",null,s("Revolut Pay is not available in editor mode")),ariaLabel:"Revolut Pay",canMakePayment:()=>Q.can_make_payment,paymentMethodId:"revolut_pay",supports:{features:["products"]}},{registerPaymentMethod:ne,registerExpressPaymentMethod:ae}=window.wc.wcBlocksRegistry;O?(ae(re),ae(J)):(ne(K),ne(re),ne(J)),(0,e.registerCheckoutBlock)(H)})()})();